# 抢票神器使用说明（Mac/*nix）

首先感谢GitHub大佬：https://github.com/testerSunshine/12306

如果各位有github账号，希望能去点个star。

然后正式开始：

### 1. 环境配置：

MacOS/Linux（有桌面）

python3.7.4(无conda环境)

Vscode(VScode天下第一！)

### 2. 克隆项目到本地

可以使用github desktop克隆到本地，也可以使用直接下载压缩包到本地，没有区别，下载好后，放到桌面，别问问什么（什么“能不能放D盘”，“我觉得我不想放Desktop，不能凸显我的技术”之类的，不能，放别的地方后面出问题自己解决。），解压缩，进入其中的master文件夹，里面有着所有需要的项目源码。

其中，需要重点关注的是2个文件，第一个叫requirements.txt，第二个叫TickerConfig.py，前一个是配置环境需要的，后一个则是更改配置需要的。

网络不好的挂个梯子，找不到别的梯子的去下蓝灯中国。

### 3.下载需要的python模块

请使用python3的pip3下载，最好的是，系统里只有python3，软件需要3.6以上，版本自己注意，python安装路径必须是默认路径不要改，加入系统PATH，不要有任何中文路径。

```bash
python3 -m pip3 install -r requireements.txt
# pip3 install -r requirements.txt
```

注意这里有个坑，如果是mac用户，那么最近可能有一次大版本更新，更新后python也跟着更新了，或者，你自己手动更新了python，或者你用homebrew安装了最新的python，这些都没关系，重要的是，装python-module的那个文件夹：site-package在哪里，一般来讲，在命令行键入python3，出来的这个python，是系统PATH内的python，但是键入pip3下载之后的模块，是不是就下载到了这个python的模块文件夹内呢？

答案是否定的，所以才有了上面两种写法，如果你出现了，明明已经用pip3安装好了，但是使用默认python却无法导入模块而且报错没有这个模块的话，检查一下你python搜索模块的默认路径是哪里，可以用下面的代码检查：

```
>python3
Python 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 16:52:21)
[Clang 6.0 (clang-600.0.57)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>>import sys
>>>sys.path()
```

然后就会在终端打印出这个python搜索模块的路径，然后你也可以用sys.path.append()把你想用的路径加进去。

这样基本能解决环境配置问题。

利用requirements.txt下载的过程可能有点慢，而且需要下载tensorflow模块，可能有点慢，稍微等一会儿就好了。

全部下载完成而且不报错的话，环境配置就完成了。

### 4.写运行配置文件

首先，运行vscode，然后open folder，打开那个master文件夹，然后你会在右边看到所有文件都有了，单击就能查看更改，改完了记得保存......

配置文件就是TickerConfig.py，首先，这不是一个普通的txt配置文件，这是一个py脚本，不要乱空格换行打分号。然后，绝大多数配置文件的写法在里面注释描述得非常清楚，照着填就是，如果你担心什么“我的账号密码都写了会不会泄漏啊”，右转携程加速包10块一个，你去看看携程用户协议去。一般来讲，这里面会有些配置可能你看不懂是啥意思，没关系， 按照我填写的经验来看，一般你看不懂的就不用改。

不要问“能不能帮我写一下？”，答案是可以，**支付宝账户18819421160**.

在填写的时候，有些地方需要注意，其一，先把输入法调成英文，别开着搜狗写了半天，报错然后问我为什么。

其二，如果你想开启邮箱通知，那么需要开stmp，其实很简单，先在QQ邮箱网页或者手机app上登陆，然后在设置里面找到开启stmp/pop服务，点开启就行，然后一堆验证照着验证就行，直到最后，会给你一个授权码，这个授权码要记好，在填写邮箱通知里面，password的部分，不要写你的密码，写验证码，具体原理感兴趣自己去查。

其三，日期，车次写对，然后12306记得确保认证通过，然后就是学生票的问题，目前看来，软件不支持改动，是这样的，如果你的乘车人里面有学生票信息，那么会默认买学生票，如果没有学生票信息，会买成人票，儿童票也一样，那么，我们可以这样，在购买人名单里，写两次名字，这样会买一张学生票买一张成人票，然后退就行了。

最后，就是chrome的问题。如果是linux，其实很简单，chrome路径很好找，但如果是mac，路径有点诡异，要去/Applications里面找，而且记得只要到Google Chrome这一级就好，空格不要用反斜杠，该空格空格。然后，你需要下载一个东西叫chromedriver，网址里面给了，如果你的chrome更新的话，那么大版本应该是79，找大版本一样的下载就行，下载下来了，**千万千万，加入到PATH里面**，最简单的是扔到/usr/loca/bin里面，大版本信息在chrome的setting里面能看到。

到此为止配置信息填写完成，可以开整了。

### 5. 运行

确认环境配置无误，然后就可以在文件夹里：

```bash
sudo python3 run.py
```

然后等着就行，终端挂后台就行了，这玩意不吃资源，另外，如果你IP被封了不要找我，自己去买代理或者IP池，不要挂云上，云的IP封起来是最容易的，如果家庭网络自动获取IP是可以隔一段时间换个IP的，自己去搜索实现。

### 6.Q&A

1.为什么不能在windows上写一个？

答：懒，而且很多人win10根本连UAC都没去掉，用户权限也没获取，搞起来C盘啥都改不了，到时候一大堆权限问题，不想再整这个。如果想再window上用，先解决UAC和用户权限，简单的标准就是，你可以在C盘的任意文件夹内新建文本文档然后再删掉它而且不会弹出任何提示。

2.我的selenium为什么报错？

一般来讲，报错的原因都是因为fake_useragent.json这个文件下载的问题，建议是，第一次运行挂个梯子，这个文件很小，只有43k，只要下载一次就行了。实在不想挂梯子的话，去网上找个版本对应的，然后加入到pyhton的临时文件目录里。

3.配置文件这么多条，看不懂啊，能不能讲一下？

答：可以，**支付宝账户18819421160**，或者可以自己去免费百度，简单得很。

4.我想用server酱微信通知，能不能......

答：不能，自己摸索去。

5.能不能帮我全套弄一下？我只想直接挂着等。

答：可以，支付宝账户......

6.能不能帮我代挂？我的电脑不想一直开着。

答：可以，支付宝......隔壁加速包10块一个你看着给吧。

7.能保证抢到票不？

答：现在放票一般是多次放票，一般来讲第一次只放少量票，在出发前一周会再有一次放票，以及平时可以捡漏，成功率还是很高的。不过，没有保证，你觉得携程和飞猪能保证么？无非就是抢不到退款而已，你在乎退款么。不怎么相信的话，可以自己手动等着去吧，另外，肯定会有人说候补，那么我告诉你，这个连候补机会都能一起抢。

8.效果咋样？

答：反正我抢到了......你自己看着办吧。
